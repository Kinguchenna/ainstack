{% extends 'partials/base.html' %}
{% load static %}
{% block title %}Free Text-To-Speech for all languages & MP3 Download | ainhub.com/txt2mp4{% endblock %}
{% block description %}Easily convert text to natural US English voice and 150+ languages/accents for free. Listen
online or download as MP3.{% endblock %}
{% load humanize %}

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>



{% block content %}

<style>
    .text_container {
        max-width: 100%;
        overflow-x: auto;
    }

    table {
        width: 100%;
    }

    @media (max-width: 700px) {
        table {
            width: 80% !important;
            padding: 0px;
        }
    }


    .btn-modern {
        padding: 0.6rem 1.4rem;
        border-radius: 999px;
        font-weight: 500;
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
        transition: all 0.2s ease-in-out;
        border: 1px solid transparent;
        background-color: #007bff;
        color: #fff;
    }

    .btn-modern:hover {
        background-color: #0056b3;
        transform: translateY(-1px);
    }

    .btn-outline-dark {
        background-color: #fff;
        border: 1px solid #333;
        color: #333;
    }

    .btn-outline-dark:hover {
        background-color: #f3f3f3;
        color: #000;
    }

    /* Modern styles for choice options */
.choice-label {
    background-color: #f9f9f9;
    transition: all 0.2s ease-in-out;
    cursor: pointer;
    border: 1px solid #ddd;
}

.choice-label:hover {
    background-color: #eef6ff;
    border-color: #007bff;
}

.form-check-input {
    accent-color: #007bff;  /* modern blue accent */
    width: 1.2em;
    height: 1.2em;
}
.question_number{
    margin-top: 20px;
    font-size: 28px;
    text-align: center;
}
.question_text{
    font-size: 22px;
}
.form-check{
    font-size: 18px;
    padding: 3px;
}
.next_prev{
    padding: 5px;
    margin-top: 20px;
}
@media (max-width: 550px) {
    .survey_container{
        margin-top: 20px;
    }
}
</style>

<body>

    {% include 'partials/header.html' %}

    <main class="main_area">


        <!-- {% include 'partials/dashbord_slider.html' %} -->

        {% if user.is_authenticated %}
        <div class="dashbord_header">
            {% if surveys %}
            {% for survey in surveys %}
            {% if survey.logo %}
            <!-- {{survey.title}} -->
            <a href="{{survey.url}}"> <img class="" style="height: 70px; width: 70px;" src="{{ survey.logo.url }}"
                    alt="Logo" > </a>

            {% endif %}
            {% endfor %}
            {% endif %}

        </div>
        {% endif %}








        <div class="main_content" style="margin-top: -80px;">

            <!-- <button id="toggleBtn0" class="toggle-btn">☰</button> -->
            {% include 'partials/message.html' %}
            {% include 'partials/success.html' %}
            <!-- {% include 'partials/dash_top_left_btn.html' %} -->

            <div class="page_content" style="margin-bottom: 50px;">
                <h2>{{ question.survey }}</h2>


                <!-- <div class="text_container">
                    <div class="login_main">
                        <div class="login-container">
                            <form method="POST" class="login-form">
                                {% csrf_token %}
                                <h4>Question {{ index|add:1 }} of {{ total }}</h4>
                                <p><strong>{{ question.question_text }}</strong></p>

                                {% if question.question_type == 'text' %}
                                <input type="text" name="{{ question.id }}" class="form-control" required>
                                {% elif question.question_type == 'radio' %}
                                {% for choice in question.choice_set.all %}
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="{{ question.id }}"
                                        value="{{ choice.id }}" required>
                                    <label class="form-check-label">{{ choice.choice_text }}</label>
                                </div>
                                {% endfor %}
                                {% elif question.question_type == 'checkbox' %}
                                {% for choice in question.choice_set.all %}
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="{{ question.id }}"
                                        value="{{ choice.id }}">
                                    <label class="form-check-label">{{ choice.choice_text }}</label>
                                </div>
                                {% endfor %}
                                {% endif %}

                                <button type="submit" class="btn btn-primary mt-3">Next</button>


                            </form>
                        </div>
                    </div>
                </div> -->

                <div class="text_container">
                    <div class="survey_main">
                        <div class="survey_container" style="margin-bottom: 50px;">
                            <!-- <form method="POST" class="login-form">
                {% csrf_token %}
                <h4>Question {{ index|add:1 }} of {{ total }}</h4>
                <p><strong>{{ question.question_text }}</strong></p>

                {% if question.question_type == 'text' %}
                    <input type="text" name="{{ question.id }}" class="form-control" required>

                {% elif question.question_type == 'radio' %}
                    {% for choice in question.choice_set.all %}
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="{{ question.id }}"
                                   value="{{ choice.id }}" required>
                            <label class="form-check-label">{{ choice.choice_text }}</label>
                        </div>
                    {% endfor %}

                {% elif question.question_type == 'checkbox' %}
                    {% for choice in question.choice_set.all %}
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="{{ question.id }}"
                                   value="{{ choice.id }}">
                            <label class="form-check-label">{{ choice.choice_text }}</label>
                        </div>
                    {% endfor %}
                {% endif %}
 

                <button type="submit" class="btn btn-primary mt-3">Next</button>
            </form> -->

                            <form method="POST" class="survey_form p-4 rounded shadow-sm bg-white">
                                {% csrf_token %}
                                <h4 class="text-muted mb-3 fs-6 question_number">Question {{ index|add:1 }} of {{ total }}</h4>

                                <p class="fs-5 fw-semibold question_text">{{ question.question_text }}</p>

                                {% if question.question_type == 'text' %}
                                <input type="text" name="{{ question.id }}" class="form-control form-control-lg rounded-3 shadow-sm" placeholder="Type your answer..." required>

                                {% elif question.question_type == 'radio' %}
                                {% for choice in question.choice_set.all %}
                                <div class="form-check">
                                    <input class="form-check-input radio" type="radio" name="{{ question.id }}"
                                        value="{{ choice.id }}" required>
                                    <label class="form-check-label">{{ choice.choice_text }}</label>
                                </div>
                                {% endfor %}

                                {% elif question.question_type == 'checkbox' %}
                                {% for choice in question.choice_set.all %}
                                <div class="form-check">
                                    <input class="form-check-input " type="checkbox" name="{{ question.id }}"
                                        value="{{ choice.id }}">
                                    <label class="form-check-label">{{ choice.choice_text }}</label>
                                </div>
                                {% endfor %}
                                {% endif %}

                                <!-- <div class="mt-3 d-flex justify-content-between">
                                    {% if index > 0 %}
                                    <a href="?q={{ index|add:" -1" }}" class="login_btn btn btn-secondary">Previous</a>
                                    {% else %}
                                    <div></div>  
                                    {% endif %}

                                    <button type="submit" class="login_btn btn btn-primary">
                                        {% if index == total|add:"-1" %}
                                        Submit
                                        {% else %}
                                        Next
                                        {% endif %}
                                    </button>
                                </div> -->

                                <div class="mt-4 d-flex justify-content-between align-items-center gap-2 next_prev">
                                    {% if index > 0 %}
                                    <a href="?q={{ index|add:" -1" }}" class="btn-modern btn-outline-dark">
                                        ← Previous
                                    </a>
                                    {% else %}
                                    <span> &nbsp; &nbsp; </span>
                                    {% endif %}
                                    &nbsp; &nbsp;
                                    <button type="submit" class="btn-modern">
                                        {% if index == total|add:"-1" %}
                                        Submit →
                                        {% else %}
                                        Next →
                                        {% endif %}
                                    </button>
                                </div>

                            </form>



                        </div>
                    </div>
                </div>





            </div>



        </div>






    </main>





    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>

        function displayError(message) {
            const errorDiv = $("#error-message");
            errorDiv.html(message).show();
        }

        function displaySuccess(message) {
            const errorDiv = $("#success-message");
            errorDiv.html(message).show();
        }

        $("#transfer_to").on("click", function (e) {
            e.preventDefault();

            const btn = document.getElementById("transfer_to");
            btn.innerText = "Transferring...";

            const to = $("#to").val();
            const amount = $("#amount").val();
            const info = $("#info").val();
            const csrf_token = $('input[name="csrfmiddlewaretoken"]').val();

            // Validate input
            if (!to || !amount) {
                displayError("Please fill in all required fields.");
                displaySuccess("");
                btn.innerText = "Transfer";
                return;
            }

            $.ajax({
                url: '/transfer_to',  // your Django view URL
                method: 'POST',
                data: {
                    to: to,
                    amount: amount,
                    info: info,
                    csrfmiddlewaretoken: csrf_token
                },
                success: function (response) {
                    displaySuccess("Success: " + response.message);
                    btn.innerText = "Transfer";
                },
                error: function (xhr, status, error) {
                    console.log("XHR Status:", status);
                    console.log("XHR Response:", xhr.responseText);
                    console.log("XHR Error:", error);

                    let msg = "Something went wrong!";

                    try {
                        const response = JSON.parse(xhr.responseText);
                        if (response.message) {
                            msg = response.message;
                        } else if (response.detail) {
                            msg = response.detail;
                        }
                    } catch (e) {
                        msg = xhr.responseText;  // fallback to raw text if not JSON
                    }

                    displayError("Error: " + msg);
                    displaySuccess("");
                    btn.innerText = "Transfer";
                }

            });
        });
    </script>







    <script>

        const toggleBtn = document.getElementById('toggleBtn');
        const toggledashboRDBtn = document.getElementById('toggledashboRDBtn');

        const dashbord_slider = document.getElementById('dashbord_slider');
        const overlay = document.getElementById('overlay');
        const mainContent = document.querySelector('.main_content');
        // sidebar.classList.toggle('open');
        // overlay.classList.toggle('show');
        toggleBtn.addEventListener('click', () => {
            // alert("Ho");
            dashbord_slider.classList.toggle('hidden');
            // mainContent.classList.toggle('expanded');
        });

        toggledashboRDBtn.addEventListener('click', () => {
            dashbord_slider.classList.toggle('hidden');
        });

    </script>




</body>

{% endblock %}

</html>